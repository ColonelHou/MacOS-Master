


##### ABA
```aidl
# 线程t1, t2同时修改内存V中的A值为B 
# 线程t3把内存中B改为A
> 第一步
t1 -> A 阻塞 
t2 -> A 成功改为 B
> 第二步
t3 在内存中取得B 成功改为 A

> 第三步
t1恢复了, compareAndSet 发现内存V中 与期望值都是A, 
将内存中A再改为B

t1以为内存一直是A， 其实被t2,t3改一圈了

```

#### ABA现实生活中问题
```aidl
# 小明取钱

# 硬件故障, 两个线程同时取
t1 -> 100元 - 50元 成功
t2 -> 100元 block 

t3 -> 此时小明妈妈给小明存了50 结果100元

此时,t2恢复了, 旧的期望值A与内存值进行比较时 能对的上(都是100), 
更改为50块

结果帐号里少了50块
```

#### 如果解决ABA问题
```aidl
# 变量增加版本号
```

#### 1. Java语言CAS底层如何实现？
> 利用unsafe提供了原子性操作方法。

#### CAS的缺点
> 1.CPU开销较大

> 2.不能保证代码块的原子性